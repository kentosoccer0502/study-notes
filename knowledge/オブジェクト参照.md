- [オブジェクトの参照について](#オブジェクトの参照について)
    - [例：予期せぬ副作用](#例予期せぬ副作用)
    - [防ぐ方法](#防ぐ方法)
- [プリミティブ型とオブジェクトの違い](#プリミティブ型とオブジェクトの違い)
  - [1. プリミティブ型（int, float, str, bool など）](#1-プリミティブ型int-float-str-bool-など)
  - [2. オブジェクト（list, dict, クラスインスタンスなど）](#2-オブジェクトlist-dict-クラスインスタンスなど)
  - [3. メモリ構造の図（テキスト版）](#3-メモリ構造の図テキスト版)
- [まとめ](#まとめ)

# オブジェクトの参照について

特に Python のように **「参照の値渡し」** を採用している言語では、

- オブジェクトを関数に渡すと、**同じメモリ上のデータを共有している**
- 関数内での属性変更やミュータブルな操作は、呼び出し元にも影響する（副作用）
- これを意識していないと、**バグの原因がコードの別の場所にあるように見えてしまう**

---

### 例：予期せぬ副作用

```python
def add_item(items):
    items.append("X")  # 元のリストを直接変更

my_list = ["A", "B"]
add_item(my_list)
print(my_list)  # ["A", "B", "X"] ← 意図せず変わっている
```

---

### 防ぐ方法

- **コピーを作って操作する**

```python
def add_item_safely(items):
    new_items = items.copy()
    new_items.append("X")
    return new_items
```

- **イミュータブルな型を使う**（tuple, frozenset など）
- 関数の仕様を明確にし、副作用があるかどうかを意識的に設計する

---

こういう「参照型の性質」を軽視すると、デバッグのときに
「え、なんでここの値が勝手に変わってるの？」
という“ホラー現象”に遭遇します。

---

希望があれば、この\*\*「副作用ホラー現象リスト」\*\*をまとめたチェックリストを作れます。
Python でありがちな参照型バグのパターン集です。

---

# プリミティブ型とオブジェクトの違い

プリミティブ型とオブジェクト（参照型）は、**メモリ上での扱い方** が異なります。
テキストベースで整理するとこうなります。

---

## 1. プリミティブ型（int, float, str, bool など）

```
変数  ──▶  値（データ本体）
```

- 変数が直接 **値そのもの** を保持
- 関数に渡すと **値のコピー** が渡される
- 関数内で再代入しても呼び出し元の値は変わらない（イミュータブル）

例：

```python
x = 10
y = x    # y に 10 がコピーされる
y = 20
print(x) # 10（影響なし）
```

---

## 2. オブジェクト（list, dict, クラスインスタンスなど）

```
変数  ──▶  参照（アドレス） ──▶  オブジェクト本体
```

- 変数が保持しているのは **オブジェクトへの参照（アドレス）**
- 関数に渡すと、**参照のコピー** が渡される（同じアドレスを指す）
- 関数内でオブジェクトの中身を変更すると、呼び出し元にも影響（ミュータブル）

例：

```python
lst1 = [1, 2]
lst2 = lst1   # 同じアドレスを共有
lst2.append(3)
print(lst1)   # [1, 2, 3]（影響あり）
```

---

## 3. メモリ構造の図（テキスト版）

```
【プリミティブ型】
x ──▶ [10]

【オブジェクト型】
carly ──▶ [参照:0x7f1234] ──▶ Personオブジェクト
                                       ├─ firstName: "Carly"
                                       └─ lastName:  "Angelo"
```

---

この「**参照型はアドレスを共有する**」という点を意識していないと、
先ほど話した「副作用ホラー現象」が起きます。

---

もし希望あれば、このプリミティブ型とオブジェクト型の**関数呼び出し時の動き比較図**も作ります。
それを見れば、副作用の発生パターンが一目で分かる形にできます。

# まとめ

- プリミティブ型 → 値をコピー（別メモリ）

- オブジェクト型 → 参照をコピー（同じメモリ）
